dailex:
  infrastructure:
    logger:
      class: Monolog\Logger
      provisioner:
        class: Dailex\Service\Provisioner\MonologServiceProvisioner
        settings:
          location: ${app.log_dir}/dailex.log
          alias: Psr\Log\LoggerInterface

    controllers:
      class: Silex\ControllerCollection
      provisioner:
        class: Dailex\Service\Provisioner\ControllerProvisioner

    message_bus:
      class: Daikon\MessageBus\MessageBus
      provisioner:
        class: Dailex\Service\Provisioner\MessageBusProvisioner
        settings:
          transports:
            inproc:
              class: Daikon\MessageBus\Channel\Subscription\Transport\InProcessTransport

    connector_map:
      class: Daikon\Dbal\Connector\ConnectorMap
      provisioner:
        class: Dailex\Service\Provisioner\ConnectorMapProvisioner

    storage_adapter_map:
      class: Daikon\Dbal\Storage\StorageAdapterMap
      provisioner:
        class: Dailex\Service\Provisioner\StorageAdapterMapProvisioner

    stream_store_map:
      class: Daikon\EventSourcing\EventStore\StreamStoreMap
      provisioner:
        class: Dailex\Service\Provisioner\StreamStoreMapProvisioner

    unit_of_work_map:
      class: Daikon\EventSourcing\EventStore\UnitOfWorkMap
      provisioner:
        class: Dailex\Service\Provisioner\UnitOfWorkMapProvisioner

    repository_map:
      class: Daikon\Dbal\Repository\RepositoryMap
      provisioner:
        class: Dailex\Service\Provisioner\RepositoryMapProvisioner

    projector_map:
      class: Daikon\Dbal\Projector\ProjectorMap
      provisioner:
        class: Dailex\Service\Provisioner\ProjectorMapProvisioner

    projector_service:
      class: Daikon\Dbal\Projector\ProjectorService
      subscriptions:
        commit_sub:
          channel: commits
          transport: inproc

    command_router:
      class: Dailex\Service\CommandRouter
      subscriptions:
        command_sub:
          channel: commands
          transport: inproc

    template_renderer:
      class: Dailex\Renderer\Twig\TwigRenderer
      provisioner:
        class: Dailex\Service\Provisioner\TwigRendererProvisioner
        settings:
          extensions:
            - Dailex\Renderer\Twig\Extension\ProjectExtension
            - Dailex\Renderer\Twig\Extension\LocaliseRouteExtension

    url_generator:
      class: Symfony\Component\Routing\Generator\UrlGenerator
      provisioner:
        class: Dailex\Service\Provisioner\SilexServiceProvisioner
        settings:
          app_key: url_generator
          alias: Symfony\Component\Routing\Generator\UrlGeneratorInterface
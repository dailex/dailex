#
# Dailex default services configuration
---
dailex:
  infrastructure:
    logger:
      class: Monolog\Logger
      provisioner:
        class: Dailex\Service\Provisioner\MonologServiceProvisioner
        settings:
          location: ${app.log_dir}/dailex.log
          alias: Psr\Log\LoggerInterface

    controllers:
      class: Silex\ControllerCollection
      provisioner:
        class: Dailex\Service\Provisioner\ControllerProvisioner

    message_bus:
      class: Daikon\MessageBus\MessageBus
      provisioner:
        class: Dailex\Service\Provisioner\MessageBusProvisioner
        settings:
          transports:
            inproc:
              class: Daikon\MessageBus\Channel\Subscription\Transport\InProcessTransport

    data_access:
      class: Dailex\Infrastructure\DataAccess\DataAccessService
      provisioner:
        class: Dailex\Service\Provisioner\DataAccessServiceProvisioner

    command_router:
      class: Dailex\Service\CommandRouter
      subscriptions:
        command_sub:
          channel: commands
          transport: inproc

    template_renderer:
      class: Dailex\Renderer\Twig\TwigRenderer
      provisioner:
        class: Dailex\Service\Provisioner\TwigRendererProvisioner
        settings:
          extensions:
            - Dailex\Renderer\Twig\Extension\ProjectExtension
            - Dailex\Renderer\Twig\Extension\LocaliseRouteExtension

    url_generator:
      class: Symfony\Component\Routing\Generator\UrlGenerator
      provisioner:
        class: Dailex\Service\Provisioner\SilexServiceProvisioner
        settings:
          app_key: url_generator
          alias: Symfony\Component\Routing\Generator\UrlGeneratorInterface